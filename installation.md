---
layout: default
title: Installation
nav_order: 3
---

# Installation
{: .no_toc }

Development for the QUTy is supported via [PlatformIO](https://platformio.org/).
You will need to install the [PlatformIO IDE for VSCode](https://platformio.org/install/ide?install=vscode),
which is available for Windows, macOS, and Linux.
{: .fs-5 .fw-300 }

## Table of Contents
{: .no_toc .text-delta }

1. TOC
{:toc}

---

## Prerequisites

1. Install the [Git client](https://git-scm.com/) on your system.
   For Windows users using an installer, the default installation
   options may be used.
2. Install [Visual Studio Code](https://code.visualstudio.com/download).
3. Install the [PlatformIO IDE extension](https://marketplace.visualstudio.com/items?itemName=platformio.platformio-ide) for VSCode.

## Installing the QUTy Platform

1. Open the **PlatformIO Home** tab in VSCode.
2. Navigate to **Platforms**, then click **Advanced Installation**.
   ![QUTy platform installation navigation](/assets/images/platform-install-navigation.png)
3. Enter the following URL and click **Install**:

   ```txt
   https://github.com/egb202/quty
   ```

   ![QUTy platform installation dialog box](/assets/images/platform-install-dialog.png)

   If VSCode was running during the installation of Git, you may need
   to restart VSCode first.

## Serial Communication Drivers

Communicating with the QUTy may require
[Silicon Labs CP210x Virtual COM Port (VCP) drivers](https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers)
to be installed on your system.

## Verifying Installation

To verify that the QUTy platform has been installed correctly, navigate
to **Platforms** and ensure that the QUTy platform is listed.

![PlatformIO Platforms](/assets/images/platformio-platforms.png)

## Verifying Driver Installation

To verify that the QUTy board is able to interface with a host machine,
connect the device using a USB cable. Then navigate to the PlatformIO
Devices tab, and ensure a device with the description "Silicon Labs
CP210x USB to UART Bridge" is listed.

The specific PORT name may vary depending on the host machine and the
number of devices connected.

![PlatformIO Devices](/assets/images/devices.png)

## Opening a Project

### Opening an Example Project

The QUTy platform offers some examples to test compilation and driver
compatibility. To access these examples, click on the QUTy platform and
open the **Examples** tab. Select the desired example and click on the
**Import** button to clone the project to your local machine.

![PlatformIO Examples](/assets/images/platformio-examples.png)

### Opening an Existing Project

To open an existing project in VSCode, ensure that the following
directory structure is maintained:

```treeview
project root/
|-- .pio # generated by PlatformIO/
|   `-- build/
|       `-- QUTy/
|-- include # header files/
|   `-- other.h
|-- lib # pre-compiled programs/
|   `-- shared.o
|-- src # source code files/
|   |-- main.S
|   `-- other.c
`-- platformio.ini
```

To open this project correctly in VSCode, select **Open Folder** and
navigate to the **root directory** of the project.

![Open Folder](/assets/images/open-folder.png)

The **Explorer** view in VSCode should now display the project structure
as shown below:

![Explorer View](/assets/images/explorer-view.png)

## PlatformIO Toolbar

After opening a project, PlatformIO will automatically configure the
build flags required for compilation when it detects the
`platformio.ini` file in the workspace root. This will reveal the
following toolbar on the top-right corner of the VSCode window:

![PlatformIO Toolbar](/assets/images/toolbar.png)

These options perform the following actions:

1. **Build** - Assembles/Compiles the project.
2. **Upload** - Assembles/Compiles the project and uploads the firmware to the microcontroller.
3. **Test** - Runs the test suite for the project (not available for the QUTy platform).
4. **Clean** - Removes the compiled binaries from the `.pio` directory. This can be useful when debugging build issues.

---

## CLI Installation

<details markdown="block">
<summary>Click to expand</summary>


For users who prefer working from the command line without the VSCode
IDE, PlatformIO Core can be installed directly.

### Installing PlatformIO Core

1. Download the `get-platformio.py` script from the PlatformIO repository.

    ```bash
    # Using curl
    curl -fsSL https://raw.githubusercontent.com/platformio/platformio-core-installer/master/get-platformio.py -o get-platformio.py

    # Using wget
    wget https://raw.githubusercontent.com/platformio/platformio-core-installer/master/get-platformio.py -O get-platformio.py
    ```

2. Install PlatformIO using Python.

    ```bash
    python get-platformio.py
    ```

    Once PlatformIO is installed to your home directory, fetch the executable location via:

    ```bash
    python get-platformio.py check core
    # (Linux/macOS) ~/.platformio/penv/bin/platformio
    # (Windows) C:\Users\username\.platformio\penv\Scripts\platformio.exe
    ```

    You may wish to add this directory to the system PATH variable or create an alias to this executable.

### Installing the QUTy Platform (CLI)

Run the following command to register the QUTy platform within PlatformIO:

```bash
pio pkg install --platform https://github.com/egb202/quty --global
```

To confirm that the installation was successful:

```bash
pio pkg list --global
```

### Building and Uploading

1. Create a `platformio.ini` file in the root directory of your project:

    ```ini
    [env:QUTy]
    platform = quty
    board = QUTy
    ```

2. Build your program:

    ```bash
    pio run
    ```

3. Build and upload to the QUTy:

    ```bash
    pio run -t upload
    ```

    If PlatformIO cannot automatically determine the port, use the `--upload-port` option. Find available ports with:

    ```bash
    pio device list
    ```

</details>
